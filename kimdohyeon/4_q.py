from bert_score import score
from itertools import combinations

# 🔹 RAG 기반 응답 (모델 이름 + 텍스트)
rag_responses = [
    ("gpt-4o", """죄송하지만, 제공된 정보로는 통합전이암진단비의 구체적인 보장 범위를 알 수 없습니다. 보험 상품의 보장 범위는 보험사와 상품에 따라 다를 수 있으므로, 해당 보험사의 약관이나 상품 설명서를 참조하시거나 보험사에 직접 문의하시는 것이 좋습니다."""),
    
    ("gpt-3.5", """죄송합니다. 이 문서에서는 "통합전이암진단비"의 구체적인 보장 범위에 대한 정보가 제공되지 않습니다."""),

    ("claude-opus-4", """제공된 문서에는 "통합전이암진단비"라는 명칭의 보장은 나타나지 않습니다. 다만 11대특정암진단비(전이암포함), 폐암진단비(전이암포함), 간암·담낭암·기타담도암 및 췌장암진단비(전이암포함), 3대특정고액암진단비(전이암포함), 소화기관암진단비(전이암포함) 등 개별 암종별로 전이암을 포함한 진단비가 보장되는 것으로 확인됩니다. 각 보장은 보험가입금액의 50~100%가 지급됩니다."""),

    ("claude-opus-3", """통합전이암진단비는 11대특정암, 폐암, 간암, 담낭암, 기타담도암, 췌장암, 3대특정고액암 등에 대해 전이암이 발생한 경우 해당 보장의 보험가입금액 100%를 지급합니다. 단, 각 암에 대한 최초 1회 진단 확정에 한해 지급됩니다.""")
]

# 🔹 LLM 일반 응답 (모델 이름 + 텍스트)
responses = [
    ("gpt-4o", """통합전이암진단비의 보장 범위는 보험 상품에 따라 다를 수 있습니다. 일반적으로 통합전이암진단비는 암이 초기 발생 부위에서 다른 부위로 전이된 경우에 대한 진단비를 보장합니다. 이 보장은 전이암으로 진단받았을 때 일시금 형태로 지급되며, 구체적인 보장 금액과 조건은 가입한 보험 상품의 약관에 따라 다를 수 있습니다. 따라서, 가입한 보험의 약관을 확인하거나 보험사에 직접 문의하여 정확한 정보를 얻는 것이 좋습니다."""),

    ("gpt-3.5", """통합전이암진단비는 보험사별로 상이할 수 있으며, 일반적으로는 보험사의 암보험 상품에 가입한 경우에 한해 보장이 이루어집니다. 따라서 암보험 상품에 따라 보장 범위가 다를 수 있으니, 보험상품의 약관을 자세히 확인하시는 것이 중요합니다. 보험사에 따라 특정 진단 검사나 치료에 대한 보장 범위가 다를 수 있으므로, 보험상품을 가입하기 전에는 반드시 약관을 숙지하고 상담을 받는 것이 좋습니다."""),

    ("claude-opus-4", """통합전이암진단비의 일반적인 보장범위를 설명드리겠습니다.

## 주요 보장내용

**1. 전이암 진단 시**
- 원발암이 다른 장기로 전이된 경우
- 최초 1회에 한해 진단비 지급
- 조직검사 등으로 확진된 경우

**2. 보장 제외 대상**
- 원발암 자체는 보장하지 않음
- 전이암이 아닌 재발암
- 계약일로부터 90일 이내 진단 시 (면책기간)

**3. 주요 특징**
- 원발암의 종류와 관계없이 전이 시 보장
- 뇌, 뼈, 간, 폐 등 주요 장기 전이 포함
- 림프절 전이도 포함되는 경우가 많음

## 확인 필요사항

보험사마다 세부 약관이 다를 수 있으니 다음 사항을 확인하세요:
- 정확한 보장 개시일
- 진단비 지급 금액
- 특정 부위 전이 제외 여부
- 중복 보장 가능 여부

가입하신 보험의 정확한 보장범위는 해당 상품의 약관을 확인하시거나 보험사에 직접 문의하시는 것이 좋습니다."""),

    ("claude-opus-3", """통합전이암진단비의 보장범위는 보험사와 상품에 따라 차이가 있을 수 있습니다. 하지만 일반적으로 다음과 같은 사항들이 포함됩니다.

1. 원발암: 최초로 발생한 암으로, 전이암을 제외한 암을 의미합니다.
2. 전이암: 원발암으로부터 다른 장기나 조직으로 퍼진 암을 말합니다. 림프절 전이, 원격 전이 등이 포함됩니다.
3. 재발암: 완치 판정을 받은 후 동일 부위에 암이 다시 발생한 경우를 말합니다.
4. 잔여암: 암 진단 후 완전히 제거되지 않고 남아있는 암세포를 의미합니다.
5. 대장점막내암: 대장 점막층에 국한된 암으로, 침윤이 없는 경우를 말합니다.
6. 제자리암: 상피세포층에 국한되어 있는 암으로, 주변 조직으로 침윤하지 않은 상태를 의미합니다.

다만, 일부 보험사에서는 전이암만을 보장하거나, 원발암과 전이암을 구분하여 보장하기도 합니다. 따라서 가입하고자 하는 보험상품의 약관을 꼼꼼히 확인하여 보장범위를 파악하는 것이 중요합니다.""")
]

# 🔹 1. LLM 응답끼리 비교
print("🔸 LLM 응답 간 BERTScore 비교:")
for (i, (name1, sent1)), (j, (name2, sent2)) in combinations(enumerate(responses), 2):
    P, R, F1 = score([sent1], [sent2], lang="ko", verbose=False)
    print(f"{name1} vs {name2} → BERTScore F1: {F1[0]:.4f}")

# 🔹 2. RAG 응답끼리 비교
print("\n🔸 RAG 응답 간 BERTScore 비교:")
for (i, (name1, sent1)), (j, (name2, sent2)) in combinations(enumerate(rag_responses), 2):
    P, R, F1 = score([sent1], [sent2], lang="ko", verbose=False)
    print(f"{name1} vs {name2} → BERTScore F1: {F1[0]:.4f}")

# 🔹 3. RAG vs LLM 응답 비교
print("\n🔸 RAG vs LLM 응답 BERTScore 비교:")
for rag_name, rag_sent in rag_responses:
    for llm_name, llm_sent in responses:
        P, R, F1 = score([rag_sent], [llm_sent], lang="ko", verbose=False)
        print(f"{rag_name} vs {llm_name} → BERTScore F1: {F1[0]:.4f}")